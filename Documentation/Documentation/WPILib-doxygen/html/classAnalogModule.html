<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>WPILIB: AnalogModule Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>AnalogModule Class Reference</h1><!-- doxytag: class="AnalogModule" --><!-- doxytag: inherits="Module" --><code>#include &lt;<a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for AnalogModule:</div>
<div class="dynsection">

<p><center><img src="classAnalogModule.png" usemap="#AnalogModule_map" border="0" alt=""></center>
<map name="AnalogModule_map">
<area href="classModule.html" alt="Module" shape="rect" coords="0,112,94,136">
<area href="classSensorBase.html" alt="SensorBase" shape="rect" coords="0,56,94,80">
<area href="classErrorBase.html" alt="ErrorBase" shape="rect" coords="0,0,94,24">
</map>
</div>

<p>
<a href="classAnalogModule-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#19bfb0c8ddf33573c4da105bee04b951">SetSampleRate</a> (float samplesPerSecond)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#b063044c14383369726b80ce93c334be">GetSampleRate</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#7c7f2eade6ca95f337d394c89f7f9da5">SetAverageBits</a> (UINT32 channel, UINT32 bits)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#5b5a1104a3415b5960d521f402b68f91">GetAverageBits</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#556054af12905bd3d38972d15ecd08dc">SetOversampleBits</a> (UINT32 channel, UINT32 bits)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#cf3aa82998c5f22099a79d24f6c77861">GetOversampleBits</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">INT16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#23f1793a4408e824b7d6b38295ea8be1">GetValue</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">INT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#501c32dcebccd03057b9f01683431f4b">GetAverageValue</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#e74bde5efa97807ce42ad9834bb5b4b2">GetAverageVoltage</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#4c2875e0c44d93ea110bc3cf4f8d740e">GetVoltage</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#1cc2b9f90b5abaa42ddfde7cbbbf7d7c">GetLSBWeight</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">INT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#3c428c04cb174c95dad6f2cb449b135f">GetOffset</a> (UINT32 channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">INT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#4d32e8352879088d4749efec89751313">VoltsToValue</a> (INT32 channel, float voltage)</td></tr>

<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#bb75added412545431fbc6a8fb6d6fbc">SlotToIndex</a> (UINT32 slot)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="classAnalogModule.html">AnalogModule</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#394c796dfcd6fb22404bfc5a50ecd56e">GetInstance</a> (UINT32 slot)</td></tr>

<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#93e13c1b5a181a92a660400c5c93c85c">kTimebase</a> = 40000000</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">40 MHz clock  <a href="#93e13c1b5a181a92a660400c5c93c85c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#2168f18fda6489141cbac5dfcd2e8343">kDefaultOversampleBits</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#0b4f6d9fd0b08bbdbce1c5abd799a67e">kDefaultAverageBits</a> = 7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#0f67b2c3cd0471a85add1583ac5420e8">kDefaultSampleRate</a> = 50000.0</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#8b2f5297ee8fef5bffacf1e0c0d01ea6">AnalogModule</a> (UINT32 slot)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#480eae8e68c3e5447e423939474b607c">~AnalogModule</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#7eeb7735bfe0f144ff9c8c65d3186fdf">GetNumActiveChannels</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#15654c0242bbf86b2344fa0cc0443bd2">GetNumChannelsToActivate</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#3f61de452642508316a5d23bb5b018ec">SetNumChannelsToActivate</a> (UINT32 <a class="el" href="AnalogChannel_8cpp.html#14d904b79be0754f7b01b2b26bc368b7">channels</a>)</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">tAI *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#13b5e4dddbb107305b856971791e3776">m_module</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#484707964546bdf52083878ef4995162">m_sampleRateSet</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">UINT32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#caca7202cd38fbcf771ce16f78238f19">m_numChannelsToActivate</a></td></tr>

<tr><td colspan="2"><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static SEM_ID&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnalogModule.html#3dc89aa13c51010119d93a99e8b3a049">m_registerWindowSemaphore</a> = NULL</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Analog <a class="el" href="classModule.html">Module</a> class. Each module can independently sample its channels at a configurable rate. There is a 64-bit hardware accumulator associated with channel 1 on each module. The accumulator is attached to the output of the oversample and average engine so that the center value can be specified in higher resolution resulting in less error. 
<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00020">20</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="8b2f5297ee8fef5bffacf1e0c0d01ea6"></a><!-- doxytag: member="AnalogModule::AnalogModule" ref="8b2f5297ee8fef5bffacf1e0c0d01ea6" args="(UINT32 slot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AnalogModule::AnalogModule           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>slot</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [explicit, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a new instance of an analog module.<p>
Create an instance of the analog module object. Initialize all the parameters to reasonable values on start. Setting a global value on an analog module can be done only once unless subsequent values are set the previously set value. Analog modules are a singleton, so the constructor is never called outside of this class.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>slot</em>&nbsp;</td><td>The slot in the chassis that the module is plugged into. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00064">64</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="480eae8e68c3e5447e423939474b607c"></a><!-- doxytag: member="AnalogModule::~AnalogModule" ref="480eae8e68c3e5447e423939474b607c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AnalogModule::~AnalogModule           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor for <a class="el" href="classAnalogModule.html">AnalogModule</a>. 
<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00095">95</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="5b5a1104a3415b5960d521f402b68f91"></a><!-- doxytag: member="AnalogModule::GetAverageBits" ref="5b5a1104a3415b5960d521f402b68f91" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 AnalogModule::GetAverageBits           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the number of averaging bits.<p>
This gets the number of averaging bits from the FPGA. The actual number of averaged samples is 2**bits. The averaging is done automatically in the FPGA.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>Channel to address. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Bits to average. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00223">223</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="501c32dcebccd03057b9f01683431f4b"></a><!-- doxytag: member="AnalogModule::GetAverageValue" ref="501c32dcebccd03057b9f01683431f4b" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT32 AnalogModule::GetAverageValue           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a sample from the output of the oversample and average engine for the channel.<p>
The sample is 12-bit + the value configured in <a class="el" href="classAnalogModule.html#556054af12905bd3d38972d15ecd08dc">SetOversampleBits()</a>. The value configured in <a class="el" href="classAnalogModule.html#7c7f2eade6ca95f337d394c89f7f9da5">SetAverageBits()</a> will cause this value to be averaged 2**bits number of samples. This is not a sliding window. The sample will not change until 2**(OversamplBits + AverageBits) samples have been acquired from the module on this channel. Use <a class="el" href="classAnalogModule.html#e74bde5efa97807ce42ad9834bb5b4b2">GetAverageVoltage()</a> to get the analog value in calibrated units.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>Channel number to read. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A sample from the oversample and average engine for the channel. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00303">303</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="e74bde5efa97807ce42ad9834bb5b4b2"></a><!-- doxytag: member="AnalogModule::GetAverageVoltage" ref="e74bde5efa97807ce42ad9834bb5b4b2" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float AnalogModule::GetAverageVoltage           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a scaled sample from the output of the oversample and average engine for the channel.<p>
The value is scaled to units of Volts using the calibrated scaling data from <a class="el" href="classAnalogModule.html#1cc2b9f90b5abaa42ddfde7cbbbf7d7c">GetLSBWeight()</a> and <a class="el" href="classAnalogModule.html#3c428c04cb174c95dad6f2cb449b135f">GetOffset()</a>. Using oversampling will cause this value to be higher resolution, but it will update more slowly. Using averaging will cause this value to be more stable, but it will update more slowly.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>The channel to read. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A scaled sample from the output of the oversample and average engine for the channel. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00383">383</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="394c796dfcd6fb22404bfc5a50ecd56e"></a><!-- doxytag: member="AnalogModule::GetInstance" ref="394c796dfcd6fb22404bfc5a50ecd56e" args="(UINT32 slot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAnalogModule.html">AnalogModule</a> * AnalogModule::GetInstance           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>slot</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get an instance of an Analog <a class="el" href="classModule.html">Module</a>.<p>
Singleton analog module creation where a module is allocated on the first use and the same module is returned on subsequent uses.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>slot</em>&nbsp;</td><td>The physical slot in the cRIO chassis where this analog module is installed. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A pointer to the <a class="el" href="classAnalogModule.html">AnalogModule</a>. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00029">29</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="1cc2b9f90b5abaa42ddfde7cbbbf7d7c"></a><!-- doxytag: member="AnalogModule::GetLSBWeight" ref="1cc2b9f90b5abaa42ddfde7cbbbf7d7c" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 AnalogModule::GetLSBWeight           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the factory scaling least significant bit weight constant. The least significant bit weight constant for the channel that was calibrated in manufacturing and stored in an eeprom in the module.<p>
Volts = ((LSB_Weight * 1e-9) * raw) - (Offset * 1e-9)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>The channel to get calibration data for. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Least significant bit weight. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00404">404</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="7eeb7735bfe0f144ff9c8c65d3186fdf"></a><!-- doxytag: member="AnalogModule::GetNumActiveChannels" ref="7eeb7735bfe0f144ff9c8c65d3186fdf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 AnalogModule::GetNumActiveChannels           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the number of channels on the module in use.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Active channels. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00159">159</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="15654c0242bbf86b2344fa0cc0443bd2"></a><!-- doxytag: member="AnalogModule::GetNumChannelsToActivate" ref="15654c0242bbf86b2344fa0cc0443bd2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 AnalogModule::GetNumChannelsToActivate           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the number of active channels.<p>
This is an internal function to allow the atomic update of both the number of active channels and the sample rate.<p>
When the number of channels changes, use the new value. Otherwise, return the curent value.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Value to write to the active channels field. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00179">179</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="3c428c04cb174c95dad6f2cb449b135f"></a><!-- doxytag: member="AnalogModule::GetOffset" ref="3c428c04cb174c95dad6f2cb449b135f" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT32 AnalogModule::GetOffset           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the factory scaling offset constant. The offset constant for the channel that was calibrated in manufacturing and stored in an eeprom in the module.<p>
Volts = ((LSB_Weight * 1e-9) * raw) - (Offset * 1e-9)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>The channel to get calibration data for. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Offset constant. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00421">421</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="cf3aa82998c5f22099a79d24f6c77861"></a><!-- doxytag: member="AnalogModule::GetOversampleBits" ref="cf3aa82998c5f22099a79d24f6c77861" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 AnalogModule::GetOversampleBits           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the number of oversample bits.<p>
This gets the number of oversample bits from the FPGA. The actual number of oversampled values is 2**bits. The oversampling is done automatically in the FPGA.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>Channel to address. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Bits to oversample. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00255">255</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="b063044c14383369726b80ce93c334be"></a><!-- doxytag: member="AnalogModule::GetSampleRate" ref="b063044c14383369726b80ce93c334be" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float AnalogModule::GetSampleRate           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the current sample rate on the module.<p>
This assumes one entry in the scan list. This is a global setting for the module and effects all channels.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Sample rate. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00145">145</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="23f1793a4408e824b7d6b38295ea8be1"></a><!-- doxytag: member="AnalogModule::GetValue" ref="23f1793a4408e824b7d6b38295ea8be1" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT16 AnalogModule::GetValue           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a sample straight from the channel on this module.<p>
The sample is a 12-bit value representing the -10V to 10V range of the A/D converter in the module. The units are in A/D converter codes. Use <a class="el" href="classAnalogModule.html#4c2875e0c44d93ea110bc3cf4f8d740e">GetVoltage()</a> to get the analog value in calibrated units.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A sample straight from the channel on this module. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00270">270</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="4c2875e0c44d93ea110bc3cf4f8d740e"></a><!-- doxytag: member="AnalogModule::GetVoltage" ref="4c2875e0c44d93ea110bc3cf4f8d740e" args="(UINT32 channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float AnalogModule::GetVoltage           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a scaled sample straight from the channel on this module.<p>
The value is scaled to units of Volts using the calibrated scaling data from <a class="el" href="classAnalogModule.html#1cc2b9f90b5abaa42ddfde7cbbbf7d7c">GetLSBWeight()</a> and <a class="el" href="classAnalogModule.html#3c428c04cb174c95dad6f2cb449b135f">GetOffset()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>The channel to read. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A scaled sample straight from the channel on this module. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00363">363</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="7c7f2eade6ca95f337d394c89f7f9da5"></a><!-- doxytag: member="AnalogModule::SetAverageBits" ref="7c7f2eade6ca95f337d394c89f7f9da5" args="(UINT32 channel, UINT32 bits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnalogModule::SetAverageBits           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>bits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of averaging bits.<p>
This sets the number of averaging bits. The actual number of averaged samples is 2**bits. Use averaging to improve the stability of your measurement at the expense of sampling rate. The averaging is done automatically in the FPGA.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>Analog channel to configure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bits</em>&nbsp;</td><td>Number of bits to average. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00208">208</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="3f61de452642508316a5d23bb5b018ec"></a><!-- doxytag: member="AnalogModule::SetNumChannelsToActivate" ref="3f61de452642508316a5d23bb5b018ec" args="(UINT32 channels)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnalogModule::SetNumChannelsToActivate           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channels</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of active channels.<p>
Store the number of active channels to set. Don't actually commit to hardware until <a class="el" href="classAnalogModule.html#19bfb0c8ddf33573c4da105bee04b951">SetSampleRate()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channels</em>&nbsp;</td><td>Number of active channels. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00193">193</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="556054af12905bd3d38972d15ecd08dc"></a><!-- doxytag: member="AnalogModule::SetOversampleBits" ref="556054af12905bd3d38972d15ecd08dc" args="(UINT32 channel, UINT32 bits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnalogModule::SetOversampleBits           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>bits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of oversample bits.<p>
This sets the number of oversample bits. The actual number of oversampled values is 2**bits. Use oversampling to improve the resolution of your measurements at the expense of sampling rate. The oversampling is done automatically in the FPGA.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>Analog channel to configure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bits</em>&nbsp;</td><td>Number of bits to oversample. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00240">240</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="19bfb0c8ddf33573c4da105bee04b951"></a><!-- doxytag: member="AnalogModule::SetSampleRate" ref="19bfb0c8ddf33573c4da105bee04b951" args="(float samplesPerSecond)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnalogModule::SetSampleRate           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>samplesPerSecond</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the sample rate on the module.<p>
This is a global setting for the module and effects all channels.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>samplesPerSecond</em>&nbsp;</td><td>The number of samples per channel per second. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00108">108</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="bb75added412545431fbc6a8fb6d6fbc"></a><!-- doxytag: member="AnalogModule::SlotToIndex" ref="bb75added412545431fbc6a8fb6d6fbc" args="(UINT32 slot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 AnalogModule::SlotToIndex           </td>
          <td>(</td>
          <td class="paramtype">UINT32&nbsp;</td>
          <td class="paramname"> <em>slot</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert slot number to index.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>slot</em>&nbsp;</td><td>The slot in the chassis where the module is plugged in. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An index to represent the module internally. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00048">48</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="4d32e8352879088d4749efec89751313"></a><!-- doxytag: member="AnalogModule::VoltsToValue" ref="4d32e8352879088d4749efec89751313" args="(INT32 channel, float voltage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT32 AnalogModule::VoltsToValue           </td>
          <td>(</td>
          <td class="paramtype">INT32&nbsp;</td>
          <td class="paramname"> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>voltage</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert a voltage to a raw value for a specified channel.<p>
This process depends on the calibration of each channel, so the channel must be specified.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>This assumes raw values. Oversampling not supported as is.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>The channel to convert for. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>voltage</em>&nbsp;</td><td>The voltage to convert. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The raw value for the channel. </dd></dl>

<p>Definition at line <a class="el" href="AnalogModule_8cpp-source.html#l00336">336</a> of file <a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a>.</p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="0b4f6d9fd0b08bbdbce1c5abd799a67e"></a><!-- doxytag: member="AnalogModule::kDefaultAverageBits" ref="0b4f6d9fd0b08bbdbce1c5abd799a67e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const long <a class="el" href="classAnalogModule.html#0b4f6d9fd0b08bbdbce1c5abd799a67e">AnalogModule::kDefaultAverageBits</a> = 7<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00025">25</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="2168f18fda6489141cbac5dfcd2e8343"></a><!-- doxytag: member="AnalogModule::kDefaultOversampleBits" ref="2168f18fda6489141cbac5dfcd2e8343" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const long <a class="el" href="classAnalogModule.html#2168f18fda6489141cbac5dfcd2e8343">AnalogModule::kDefaultOversampleBits</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00024">24</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="0f67b2c3cd0471a85add1583ac5420e8"></a><!-- doxytag: member="AnalogModule::kDefaultSampleRate" ref="0f67b2c3cd0471a85add1583ac5420e8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const float <a class="el" href="classAnalogModule.html#0f67b2c3cd0471a85add1583ac5420e8">AnalogModule::kDefaultSampleRate</a> = 50000.0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00026">26</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="93e13c1b5a181a92a660400c5c93c85c"></a><!-- doxytag: member="AnalogModule::kTimebase" ref="93e13c1b5a181a92a660400c5c93c85c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const long <a class="el" href="classAnalogModule.html#93e13c1b5a181a92a660400c5c93c85c">AnalogModule::kTimebase</a> = 40000000<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
40 MHz clock 
<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00023">23</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="13b5e4dddbb107305b856971791e3776"></a><!-- doxytag: member="AnalogModule::m_module" ref="13b5e4dddbb107305b856971791e3776" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tAI* <a class="el" href="classAnalogModule.html#13b5e4dddbb107305b856971791e3776">AnalogModule::m_module</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00056">56</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="caca7202cd38fbcf771ce16f78238f19"></a><!-- doxytag: member="AnalogModule::m_numChannelsToActivate" ref="caca7202cd38fbcf771ce16f78238f19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 <a class="el" href="classAnalogModule.html#caca7202cd38fbcf771ce16f78238f19">AnalogModule::m_numChannelsToActivate</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00058">58</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="3dc89aa13c51010119d93a99e8b3a049"></a><!-- doxytag: member="AnalogModule::m_registerWindowSemaphore" ref="3dc89aa13c51010119d93a99e8b3a049" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEM_ID <a class="el" href="classAnalogModule.html#3dc89aa13c51010119d93a99e8b3a049">AnalogModule::m_registerWindowSemaphore</a> = NULL<code> [static, private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00050">50</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="484707964546bdf52083878ef4995162"></a><!-- doxytag: member="AnalogModule::m_sampleRateSet" ref="484707964546bdf52083878ef4995162" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classAnalogModule.html#484707964546bdf52083878ef4995162">AnalogModule::m_sampleRateSet</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="AnalogModule_8h-source.html#l00057">57</a> of file <a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="AnalogModule_8h-source.html">AnalogModule.h</a><li><a class="el" href="AnalogModule_8cpp-source.html">AnalogModule.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Feb 9 11:20:46 2011 for WPILIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
